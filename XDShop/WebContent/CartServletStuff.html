<!DOCTYPE html>
<html>
<head>
<meta charset="ISO-8859-1">
<title>Product List</title>     
</head>
<body>
<button id = "get">GET ALL PRODUCTS</button>
<button id = "getCart">GET CART</button>
<div id = "productListing"></div>
<label>What product do you want?</label>
<input type = "number" id = "product"/>
<label>How many?</label>
<input type = "number" id = "qty"/>
<button id = "addToCart">Add to cart</button>
<br>
<label>What product do you want to remove?</label>
<input type = "number" id = "productToBeRemoved"/>
<button id = "removeFromCart">Remove from Cart</button>
<br>
<label>Address?</label>
<input type = "number" id = "address"/>
<button id = "checkoutCart">Checkout cart?</button>
<br>
</div>
</body>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script>

$("#addToCart").click(function(){
	var username = document.cookie.split("=")[1];
	var prodId = document.getElementById("product").value;
	var qty = document.getElementById("qty").value;
	$.post("CartServlet?param=addItemToCart&username="+username+"&prodId="+prodId+"&qty="+qty, function(obj){
		if(obj == "true")	
			console.log("Item successfully added");
		else
			console.log("Invalid input");
	});
});

$("#getCart").click(function(){
	var username = document.cookie.split("=")[1];
	$.get("CartServlet?param=get&username="+username, function(obj){
		var cart = JSON.parse(obj);
		console.log(cart);
		alert("Check console to see cart");
	});
});
$("#removeFromCart").click(function(){
	var username = document.cookie.split("=")[1];
	var prodId = document.getElementById("productToBeRemoved").value;
	$.post("CartServlet?param=removeFromCart&username="+username+"&prodId="+prodId, function(obj){
		if(obj == "true")	
			console.log("Item successfully removed");
		else
			console.log("Invalid input");
	});
});

$("#checkoutCart").click(function(){
	var username = document.cookie.split("=")[1];
	var address = document.getElementById("address").value;
	$.post("CartServlet?param=checkOutCart&username="+username+"&address="+address, function(obj){
		if(obj == "true")	
			console.log("Item successfully added");
		else
			console.log("Invalid input");
	});
});

$("#get").click(function(){
			var username = document.cookie.split("=")[1];
            $.get("ProductServlet?param=all", function(obj)
            {
            	console.log(obj);
                //imageCount = obj.split(",,,").length - 1;
                addPhotos(obj);
            });
            
            function addPhotos(obj)
            {
                if(obj!=null){
                    var jsonarr = JSON.parse(obj);	
                    var x = jsonarr.length;
                    if(obj!=""){
                        for (var i = 0; i < x; i++)
                        {
                            var jsonobj = jsonarr[i];
                            var photo = $("<div>");
                            $(photo).addClass("photos");
                            $(photo).addClass("col-md-2");
                            $(photo).prepend("<img height = 125 width = 125 class = 'img img-responsive' src = '" + jsonobj.img_link + "'/>");
                            var imgid = $("<div>");
                            $(imgid).addClass("id");
                            $((imgid).html("<p>" + jsonobj.p_id + "</p>"));  
                            $(photo).append(imgid); 
                            $("#productListing").append(photo);	
                        }
                    }
                    
                }
            }
        });
</script> 
</html>